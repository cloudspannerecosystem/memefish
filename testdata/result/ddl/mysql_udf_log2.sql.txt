--- mysql_udf_log2.sql
CREATE OR REPLACE FUNCTION mysql.LOG2(x FLOAT64) RETURNS FLOAT64 AS (
  SAFE.IF(x > 0, SAFE.LOG(x, 2), NULL)
)
--- AST
&ast.CreateFunction{
  As:        65,
  RparenAs:  109,
  OrReplace: true,
  Name:      &ast.Path{
    Idents: []*ast.Ident{
      &ast.Ident{
        NamePos: 27,
        NameEnd: 32,
        Name:    "mysql",
      },
      &ast.Ident{
        NamePos: 33,
        NameEnd: 37,
        Name:    "LOG2",
      },
    },
  },
  Params: []*ast.FunctionParam{
    &ast.FunctionParam{
      Name: &ast.Ident{
        NamePos: 38,
        NameEnd: 39,
        Name:    "x",
      },
      Type: &ast.ScalarSchemaType{
        NamePos: 40,
        Name:    "FLOAT64",
      },
    },
  },
  ReturnType: &ast.ScalarSchemaType{
    NamePos: 57,
    Name:    "FLOAT64",
  },
  Definition: &ast.CallExpr{
    Rparen: 107,
    Func:   &ast.Path{
      Idents: []*ast.Ident{
        &ast.Ident{
          NamePos: 72,
          NameEnd: 76,
          Name:    "SAFE",
        },
        &ast.Ident{
          NamePos: 77,
          NameEnd: 79,
          Name:    "IF",
        },
      },
    },
    Args: []ast.Arg{
      &ast.ExprArg{
        Expr: &ast.BinaryExpr{
          Op:   ">",
          Left: &ast.Ident{
            NamePos: 80,
            NameEnd: 81,
            Name:    "x",
          },
          Right: &ast.IntLiteral{
            ValuePos: 84,
            ValueEnd: 85,
            Base:     10,
            Value:    "0",
          },
        },
      },
      &ast.ExprArg{
        Expr: &ast.CallExpr{
          Rparen: 100,
          Func:   &ast.Path{
            Idents: []*ast.Ident{
              &ast.Ident{
                NamePos: 87,
                NameEnd: 91,
                Name:    "SAFE",
              },
              &ast.Ident{
                NamePos: 92,
                NameEnd: 95,
                Name:    "LOG",
              },
            },
          },
          Args: []ast.Arg{
            &ast.ExprArg{
              Expr: &ast.Ident{
                NamePos: 96,
                NameEnd: 97,
                Name:    "x",
              },
            },
            &ast.ExprArg{
              Expr: &ast.IntLiteral{
                ValuePos: 99,
                ValueEnd: 100,
                Base:     10,
                Value:    "2",
              },
            },
          },
        },
      },
      &ast.ExprArg{
        Expr: &ast.NullLiteral{
          Null: 103,
        },
      },
    },
  },
}

--- SQL
CREATE OR REPLACE FUNCTION mysql.LOG2 (x FLOAT64) RETURNS FLOAT64 AS (SAFE.`IF`(x > 0, SAFE.LOG(x, 2), NULL))
